(function(a){a.Template=function(){var f={},e={"\\":"\\\\","\n":"\\n","\r":"\\r","{{":"');cb(","}}":");cb('","{%":"');","%}":"\ncb('"};return function(h,i,g){f[h=h||""]=f[h]||new Function("_","cb","with(_){"+("%}"+h+"{%").replace(/([\\\n\r]|{{|}}|{%|%})/g,function(k){return e[k]})+"}return cb");try{return i?f[h](i,g):f[h]}catch(j){return j}}};a.StringBuffer=function(){var e=[],f=function(g){e.push(g)};f.toString=function(){return e.join("")};return f};function d(g,f,e){return g instanceof Function&&g.apply(f,e)}var b={};a.Event=function(g,f,e){if(g instanceof Event){var h=b[e];return h&&d(h[f],h,[g])}else{e=g._index;if(e){b[e]=g;return{on:function(j,i){g[j]=i;return"tplite.Event(event, "+j+", "+e+")"},off:function(){Object.keys(g).map(function(i){if(i>0){delete g[i]}})}}}}};var c=0;a.Component=function(s,m,g,r){var k=++c;var n=false;var u=new a.Template();var v=u(s);var t={state:g,render:h,mount:p,setState:j,trigger:i,root:r,_index:k};var l=a.Event(t);var q=Object.keys(m).reduce(function(e,w){e[w]=function(){unshift.call(arguments,w);return o.apply(t,arguments)};return e},{bind:o,sub:function f(){var e=a.Component.apply({},arguments);l.on(++c,e.setState({parent:t}));return e.render()}});function o(w){var e=slice.call(arguments,1);return l.on(++c,function(x){return d(m[w],t,e.concat(x))})}function i(w){var e=slice.call(arguments,1);return !m[w]||d(m[w],t,e)}function j(e){t.state=g=assign({},g,e);if(r&&g&&i("shouldUpdate")){l.off();h();requestAnimationFrame(function(){i("onUpdate");if(!n){i("onMount");n=true}})}return t}function h(){var e=new a.StringBuffer();v(assign(g,q),e);if(r){return r.innerHTML=e.toString()}return e.toString()}function p(e){r=e;j();return t}i("onInit");return p(r)}}(typeof exports==="undefined"?this.tplite||(this.tplite={}):exports));